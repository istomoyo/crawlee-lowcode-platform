# Crawlee ä½ä»£ç çˆ¬è™«å¹³å° - é¡¹ç›®æ–‡æ¡£ï¼ˆå­¦ä¹ ç»ƒä¹ è‡ªç”¨ï¼‰

## ğŸ“‹ ç›®å½•

- [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
- [é¡¹ç›®åŠŸèƒ½](#é¡¹ç›®åŠŸèƒ½)
- [ç›®å‰å·²ä¼˜åŒ–](#ç›®å‰å·²ä¼˜åŒ–)
- [å¾…ä¼˜åŒ–é¡¹](#å¾…ä¼˜åŒ–é¡¹)
- [ä½¿ç”¨æ–¹æ³•](#ä½¿ç”¨æ–¹æ³•)
- [API æ¥å£](#api-æ¥å£)
- [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)

---

## ğŸ“– é¡¹ç›®æ¦‚è¿°

**Crawlee ä½ä»£ç çˆ¬è™«å¹³å°** æ˜¯ä¸€ä¸ªåŸºäº Crawlee æ¡†æ¶çš„å¯è§†åŒ–çˆ¬è™«ç®¡ç†å¹³å°ï¼Œæ”¯æŒé€šè¿‡ä½ä»£ç æ–¹å¼åˆ›å»ºå’Œç®¡ç†çˆ¬è™«ä»»åŠ¡ã€‚å¹³å°æä¾›äº†å®Œæ•´çš„ä»»åŠ¡ç®¡ç†ã€æ‰§è¡Œç›‘æ§ã€æ•°æ®å¯¼å‡ºç­‰åŠŸèƒ½ã€‚

### æ ¸å¿ƒç‰¹æ€§

- ğŸ¯ **ä½ä»£ç çˆ¬è™«åˆ›å»º** - å¯è§†åŒ–é…ç½®ï¼Œæ— éœ€ç¼–å†™ä»£ç 
- ğŸš€ **åŸºäº Crawlee** - å¼ºå¤§çš„çˆ¬è™«å¼•æ“ï¼Œæ”¯æŒ Playwrightã€Cheerioã€Puppeteer
- ğŸ“Š **å®æ—¶ç›‘æ§** - WebSocket å®æ—¶æ›´æ–°ä»»åŠ¡çŠ¶æ€
- ğŸ“¦ **æ•°æ®å¯¼å‡º** - æ”¯æŒ JSONã€ZIP ç­‰å¤šç§æ ¼å¼
- ğŸ‘¥ **ç”¨æˆ·æƒé™** - æ”¯æŒç®¡ç†å‘˜å’Œæ™®é€šç”¨æˆ·è§’è‰²
- ğŸ“ˆ **ç»Ÿè®¡åˆ†æ** - ä»»åŠ¡æ‰§è¡Œç»Ÿè®¡å’Œè¶‹åŠ¿åˆ†æ

---

## ğŸ›  æŠ€æœ¯æ ˆ

### å‰ç«¯æŠ€æœ¯

- **æ¡†æ¶**: Vue 3 + TypeScript
- **æ„å»ºå·¥å…·**: Vite
- **UI ç»„ä»¶åº“**: Element Plus
- **æ ·å¼**: TailwindCSS
- **çŠ¶æ€ç®¡ç†**: Pinia
- **è·¯ç”±**: Vue Router
- **HTTP å®¢æˆ·ç«¯**: Axios
- **å›¾è¡¨**: ECharts
- **æµç¨‹å›¾**: Vue Flow (@vue-flow/core)
- **WebSocket**: Socket.IO Client

### åç«¯æŠ€æœ¯

- **æ¡†æ¶**: NestJS + TypeScript
- **ORM**: TypeORM
- **æ•°æ®åº“**: MySQL
- **ç¼“å­˜**: Redis (ioredis)
- **çˆ¬è™«å¼•æ“**: Crawlee (Playwright)
- **è®¤è¯**: JWT + Passport
- **æ–‡ä»¶ä¸Šä¼ **: Multer
- **WebSocket**: Socket.IO
- **API æ–‡æ¡£**: Swagger
- **å¥åº·æ£€æŸ¥**: @nestjs/terminus
- **é€Ÿç‡é™åˆ¶**: @nestjs/throttler

---

## ğŸ¯ é¡¹ç›®åŠŸèƒ½

### 1. ç”¨æˆ·ç®¡ç†æ¨¡å—

#### åŠŸèƒ½åˆ—è¡¨
- âœ… ç”¨æˆ·æ³¨å†Œï¼ˆé‚®ç®±éªŒè¯ç ï¼‰
- âœ… ç”¨æˆ·ç™»å½•ï¼ˆJWT è®¤è¯ï¼‰
- âœ… å•è®¾å¤‡ç™»å½•ï¼ˆRedis ç®¡ç†ï¼‰
- âœ… ç”¨æˆ·ä¿¡æ¯ç®¡ç†
- âœ… å¯†ç ä¿®æ”¹
- âœ… å¤´åƒä¸Šä¼ 
- âœ… è§’è‰²æƒé™ï¼ˆç®¡ç†å‘˜/æ™®é€šç”¨æˆ·ï¼‰

#### æƒé™æ§åˆ¶
- **æ™®é€šç”¨æˆ·**: åªèƒ½ç®¡ç†è‡ªå·±çš„ä»»åŠ¡
- **ç®¡ç†å‘˜**: å¯ä»¥ç®¡ç†æ‰€æœ‰ç”¨æˆ·å’Œä»»åŠ¡ï¼ŒæŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—å’Œè®¾ç½®

### 2. ä»»åŠ¡ç®¡ç†æ¨¡å—

#### ä»»åŠ¡åˆ›å»ºæµç¨‹
1. **åŸºæœ¬ä¿¡æ¯** - è®¾ç½®ä»»åŠ¡åç§°å’Œ URL
2. **ç»“æ„è¯†åˆ«** - è‡ªåŠ¨è¯†åˆ«åˆ—è¡¨ç»“æ„æˆ–æ‰‹åŠ¨é€‰æ‹©
3. **å­—æ®µæ˜ å°„** - é…ç½®è¦æå–çš„æ•°æ®å­—æ®µ
   - æ”¯æŒ XPath å’Œ JSPath é€‰æ‹©å™¨
   - æ”¯æŒæ–‡æœ¬ã€é“¾æ¥ã€å›¾ç‰‡ç±»å‹
   - æ”¯æŒ HTMLã€Markdown æ ¼å¼è½¬æ¢
   - æ”¯æŒåµŒå¥—å­—æ®µå’Œåˆ†é¡µ
4. **é«˜çº§é…ç½®** - æµè§ˆå™¨è®¾ç½®ã€å¹¶å‘æ•°ã€è¶…æ—¶ç­‰
5. **é¢„è§ˆæµ‹è¯•** - é¢„è§ˆçˆ¬å–ç»“æœ

#### ä»»åŠ¡æ‰§è¡Œ
- âœ… æ‰‹åŠ¨æ‰§è¡Œä»»åŠ¡
- âœ… å¿«é€Ÿæ‰§è¡Œï¼ˆåˆ›å»ºæ–°ä»»åŠ¡å‰¯æœ¬ï¼‰
- âœ… ä»»åŠ¡é˜Ÿåˆ—ç®¡ç†
- âœ… å®æ—¶çŠ¶æ€æ›´æ–°ï¼ˆWebSocketï¼‰
- âœ… æ‰§è¡Œè¿›åº¦æ˜¾ç¤º
- âœ… æ‰§è¡Œæ—¥å¿—æŸ¥çœ‹

#### ä»»åŠ¡ç®¡ç†
- âœ… ä»»åŠ¡åˆ—è¡¨ï¼ˆåˆ†é¡µã€æœç´¢ï¼‰
- âœ… ä»»åŠ¡ç¼–è¾‘
- âœ… ä»»åŠ¡åˆ é™¤
- âœ… ä»»åŠ¡å¤åˆ¶
- âœ… æ‰§è¡Œå†å²æŸ¥çœ‹

### 3. æ•°æ®æå–åŠŸèƒ½

#### æ”¯æŒçš„é€‰æ‹©å™¨ç±»å‹
- **XPath** - æ”¯æŒç»å¯¹è·¯å¾„å’Œç›¸å¯¹è·¯å¾„
- **JSPath** - JavaScript è·¯å¾„è¡¨è¾¾å¼
- **CSS é€‰æ‹©å™¨** - æ ‡å‡† CSS é€‰æ‹©å™¨

#### æ”¯æŒçš„æ•°æ®ç±»å‹
- **æ–‡æœ¬** - çº¯æ–‡æœ¬ã€HTMLã€Markdown
- **é“¾æ¥** - æå– href å±æ€§ï¼Œè‡ªåŠ¨è½¬æ¢ä¸ºç»å¯¹ URL
- **å›¾ç‰‡** - æå– srcã€data-srcã€data-original å±æ€§

#### é«˜çº§åŠŸèƒ½
- âœ… åˆ†é¡µæ”¯æŒï¼ˆè‡ªåŠ¨ç¿»é¡µï¼‰
- âœ… æ»šåŠ¨åŠ è½½ï¼ˆæ— é™æ»šåŠ¨ï¼‰
- âœ… å­é¡µé¢å¯¼èˆªï¼ˆé€šè¿‡é“¾æ¥è·³è½¬åˆ°è¯¦æƒ…é¡µï¼‰
- âœ… ç›¸å¯¹è·¯å¾„è‡ªåŠ¨è½¬æ¢
- âœ… æ‡’åŠ è½½å›¾ç‰‡æ”¯æŒ

### 4. ç»“æœç®¡ç†æ¨¡å—

#### ç»“æœæŸ¥çœ‹
- âœ… æ‰§è¡Œç»“æœåˆ—è¡¨
- âœ… ç»“æœè¯¦æƒ…æŸ¥çœ‹
- âœ… ç»“æœæ•°æ®é¢„è§ˆ
- âœ… ç»“æœæ–‡ä»¶ä¸‹è½½

#### ç»“æœå¯¼å‡º
- âœ… JSON æ ¼å¼å¯¼å‡º
- âœ… ZIP æ‰“åŒ…å¯¼å‡ºï¼ˆåŒ…å«å›¾ç‰‡ã€æ–‡ä»¶ï¼‰
- âœ… è‡ªå®šä¹‰æ‰“åŒ…é…ç½®
- âœ… æ‰¹é‡å¯¼å‡º

### 5. ç»Ÿè®¡åˆ†ææ¨¡å—

#### ç»Ÿè®¡æŒ‡æ ‡
- âœ… ä»»åŠ¡æ€»æ•°ã€æˆåŠŸæ•°ã€å¤±è´¥æ•°
- âœ… æˆåŠŸç‡ç»Ÿè®¡
- âœ… è¶‹åŠ¿åˆ†æï¼ˆæŒ‰æ—¥æœŸï¼‰
- âœ… æ•°æ®åˆ†å¸ƒç»Ÿè®¡
- âœ… æ‰§è¡Œæ—¶é—´åˆ†å¸ƒ
- âœ… ä»»åŠ¡ç±»å‹åˆ†å¸ƒ
- âœ… æœ€è¿‘æ‰§è¡Œè®°å½•

### 6. ç®¡ç†å‘˜åŠŸèƒ½

#### ç”¨æˆ·ç®¡ç†
- âœ… ç”¨æˆ·åˆ—è¡¨æŸ¥çœ‹
- âœ… ç”¨æˆ·ä¿¡æ¯ç¼–è¾‘
- âœ… ç”¨æˆ·åˆ é™¤
- âœ… ç”¨æˆ·æœç´¢

#### ä»»åŠ¡ç›‘æ§
- âœ… æ‰€æœ‰ä»»åŠ¡æŸ¥çœ‹
- âœ… ä»»åŠ¡æ‰§è¡Œç›‘æ§
- âœ… ç³»ç»Ÿèµ„æºç›‘æ§

#### ç³»ç»Ÿæ—¥å¿—
- âœ… ç³»ç»Ÿæ—¥å¿—æŸ¥çœ‹
- âœ… æ—¥å¿—ç­›é€‰ï¼ˆæŒ‰çº§åˆ«ã€æ¨¡å—ã€æ—¶é—´ï¼‰
- âœ… æ—¥å¿—ç»Ÿè®¡

#### ç³»ç»Ÿè®¾ç½®
- âœ… ç³»ç»Ÿå‚æ•°é…ç½®
- âœ… é»˜è®¤è®¾ç½®åˆå§‹åŒ–

### 7. ç³»ç»ŸåŠŸèƒ½

#### å¥åº·æ£€æŸ¥
- âœ… æ•°æ®åº“è¿æ¥æ£€æŸ¥
- âœ… Redis è¿æ¥æ£€æŸ¥
- âœ… å†…å­˜ä½¿ç”¨æ£€æŸ¥
- âœ… å°±ç»ªæ£€æŸ¥ï¼ˆ/health/readyï¼‰
- âœ… å­˜æ´»æ£€æŸ¥ï¼ˆ/health/liveï¼‰

#### API æ–‡æ¡£
- âœ… Swagger UI æ–‡æ¡£
- âœ… åœ¨çº¿æ¥å£æµ‹è¯•
- âœ… Bearer Token å’Œ Cookie è®¤è¯æ”¯æŒ

---

## âœ… ç›®å‰å·²ä¼˜åŒ–

### ğŸ”´ é«˜ä¼˜å…ˆçº§ - å®‰å…¨æ€§ä¼˜åŒ–

#### 1. ç¯å¢ƒå˜é‡é…ç½® âœ…
- âœ… ä½¿ç”¨ `@nestjs/config` ç»Ÿä¸€ç®¡ç†é…ç½®
- âœ… ç§»é™¤ç¡¬ç¼–ç çš„æ•°æ®åº“å’Œ Redis é…ç½®
- âœ… æ”¯æŒå¤šç¯å¢ƒé…ç½®ï¼ˆå¼€å‘/ç”Ÿäº§ï¼‰
- âœ… åˆ›å»ºç¯å¢ƒå˜é‡é…ç½®è¯´æ˜æ–‡æ¡£

**é…ç½®æ–‡ä»¶**: `backend/crawler/src/config/configuration.ts`

#### 2. CORS é…ç½®ä¼˜åŒ– âœ…
- âœ… ä»å…è®¸æ‰€æœ‰æ¥æºæ”¹ä¸ºé…ç½®åŒ–çš„åŸŸååˆ—è¡¨
- âœ… æ”¯æŒç”Ÿäº§ç¯å¢ƒå®‰å…¨é…ç½®
- âœ… é…ç½®å…è®¸çš„ HTTP æ–¹æ³•å’Œè¯·æ±‚å¤´

**é…ç½®ä½ç½®**: `backend/crawler/src/main.ts`

#### 3. API é€Ÿç‡é™åˆ¶ âœ…
- âœ… å…¨å±€é€Ÿç‡é™åˆ¶ï¼š100 æ¬¡/60 ç§’
- âœ… ç™»å½•æ¥å£ï¼š5 æ¬¡/15 åˆ†é’Ÿï¼ˆé˜²æ­¢æš´åŠ›ç ´è§£ï¼‰
- âœ… æ³¨å†Œæ¥å£ï¼š3 æ¬¡/10 åˆ†é’Ÿ
- âœ… éªŒè¯ç æ¥å£ï¼š5 æ¬¡/åˆ†é’Ÿ

**å®ç°**: `@nestjs/throttler` æ¨¡å—

#### 4. æ•æ„Ÿä¿¡æ¯æ¸…ç† âœ…
- âœ… ç§»é™¤ JWT secret ç­‰æ•æ„Ÿä¿¡æ¯çš„æ—¥å¿—è¾“å‡º
- âœ… æ¸…ç†æ‰€æœ‰è°ƒè¯•æ—¥å¿—
- âœ… ä½¿ç”¨ NestJS Logger æ›¿ä»£ console.log

### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ - ä»£ç è´¨é‡ä¼˜åŒ–

#### 5. æ—¥å¿—ç³»ç»Ÿä¼˜åŒ– âœ…
- âœ… æ›¿æ¢æ‰€æœ‰ `console.log` ä¸º NestJS Loggerï¼ˆçº¦ 50+ å¤„ï¼‰
- âœ… ç»Ÿä¸€æ—¥å¿—æ ¼å¼å’Œçº§åˆ«
- âœ… ä¿ç•™æµè§ˆå™¨ç«¯ consoleï¼ˆåˆç†ä½¿ç”¨ï¼‰

**ä¼˜åŒ–çš„æ–‡ä»¶**:
- `src/main.ts`
- `src/auth/jwt-auth.guard.ts`
- `src/task/task.controller.ts`
- `src/task/task.service.ts`
- `src/task/crawlee-engine.service.ts`
- `src/admin/admin.module.ts`
- `src/admin/system-settings.service.ts`
- `src/admin/logger.service.ts`

#### 6. API æ–‡æ¡£ âœ…
- âœ… é›†æˆ Swagger/OpenAPI
- âœ… è‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£
- âœ… æ”¯æŒåœ¨çº¿æµ‹è¯•æ¥å£
- âœ… è®¿é—®åœ°å€ï¼š`http://localhost:3000/api`

#### 7. å¥åº·æ£€æŸ¥æ¥å£ âœ…
- âœ… æ•°æ®åº“å¥åº·æ£€æŸ¥
- âœ… Redis å¥åº·æ£€æŸ¥
- âœ… å†…å­˜å¥åº·æ£€æŸ¥
- âœ… å°±ç»ªæ£€æŸ¥å’Œå­˜æ´»æ£€æŸ¥

**æ¥å£**:
- `GET /health` - å®Œæ•´å¥åº·æ£€æŸ¥
- `GET /health/ready` - å°±ç»ªæ£€æŸ¥
- `GET /health/live` - å­˜æ´»æ£€æŸ¥

### ğŸ—‘ï¸ æ–‡ä»¶æ¸…ç† âœ…
- âœ… åˆ é™¤ Docker ç›¸å…³ç¤ºä¾‹æ–‡ä»¶
- âœ… åˆ é™¤é…ç½®ç¤ºä¾‹æ–‡ä»¶
- âœ… æ¸…ç†å¤šä½™æ–‡ä»¶

---

## ğŸ“ å¾…ä¼˜åŒ–é¡¹

### ğŸ”´ é«˜ä¼˜å…ˆçº§

#### 1. è¾“å…¥éªŒè¯å¢å¼º
- â³ å®Œå–„æ‰€æœ‰ DTO çš„éªŒè¯è§„åˆ™
- â³ XSS é˜²æŠ¤
- â³ SQL æ³¨å…¥é˜²æŠ¤ï¼ˆTypeORM å·²å¤„ç†ï¼Œéœ€ç¡®è®¤ï¼‰

#### 2. é”™è¯¯å¤„ç†å¢å¼º
- â³ æ›´è¯¦ç»†çš„é”™è¯¯ä¸Šä¸‹æ–‡
- â³ åŒºåˆ†ä¸šåŠ¡é”™è¯¯å’Œç³»ç»Ÿé”™è¯¯
- â³ é”™è¯¯ä¸ŠæŠ¥æœºåˆ¶ï¼ˆå¦‚ Sentryï¼‰

### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§

#### 3. æµ‹è¯•è¦†ç›–ç‡
- â³ æé«˜å•å…ƒæµ‹è¯•è¦†ç›–ç‡ï¼ˆç›®æ ‡ >80%ï¼‰
- â³ å®Œå–„ E2E æµ‹è¯•
- â³ é…ç½®æµ‹è¯•æ•°æ®åº“

#### 4. æ—¥å¿—è½®è½¬å’Œå½’æ¡£
- â³ é…ç½®æ—¥å¿—è½®è½¬
- â³ æ—¥å¿—èšåˆï¼ˆå¦‚ ELK Stackï¼‰
- â³ æ—¥å¿—çº§åˆ«åŠ¨æ€è°ƒæ•´

### ğŸŸ¢ åŠŸèƒ½å¢å¼º

#### 5. ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ â­â­â­
- â³ é›†æˆ `@nestjs/schedule` æˆ– Bull Queue
- â³ æ”¯æŒ Cron è¡¨è¾¾å¼
- â³ ä»»åŠ¡è°ƒåº¦ç®¡ç†ç•Œé¢
- â³ æ”¯æŒä»»åŠ¡ä¾èµ–å’Œé“¾å¼æ‰§è¡Œ

#### 6. æ•°æ®å¯¼å‡ºåŠŸèƒ½å¢å¼º â­â­â­
- â³ æ”¯æŒ CSVã€Excelã€XML æ ¼å¼
- â³ æ‰¹é‡å¯¼å‡º
- â³ å¯¼å‡ºä»»åŠ¡é˜Ÿåˆ—ç®¡ç†
- â³ å¯¼å‡ºå†å²è®°å½•

#### 7. ä»»åŠ¡æ¨¡æ¿ç³»ç»Ÿ â­â­
- â³ åˆ›å»ºä»»åŠ¡æ¨¡æ¿
- â³ æ¨¡æ¿å¸‚åœº/åˆ†äº«
- â³ æ¨¡æ¿å¯¼å…¥/å¯¼å‡º
- â³ å¸¸ç”¨æ¨¡æ¿æ¨è

#### 8. ç›‘æ§å’Œå‘Šè­¦ â­â­â­
- â³ ä»»åŠ¡æ‰§è¡Œç›‘æ§ä»ªè¡¨æ¿
- â³ ç³»ç»Ÿèµ„æºç›‘æ§ï¼ˆCPUã€å†…å­˜ã€ç£ç›˜ï¼‰
- â³ å¼‚å¸¸å‘Šè­¦ï¼ˆé‚®ä»¶/Webhookï¼‰
- â³ æ€§èƒ½æŒ‡æ ‡æ”¶é›†

#### 9. æ•°æ®å¤‡ä»½å’Œæ¢å¤ â­â­
- â³ å®šæœŸæ•°æ®åº“å¤‡ä»½
- â³ ä»»åŠ¡é…ç½®å¤‡ä»½
- â³ ä¸€é”®æ¢å¤åŠŸèƒ½
- â³ å¤‡ä»½æ–‡ä»¶ç®¡ç†

#### 10. ç”¨æˆ·é…é¢å’Œé™åˆ¶ç®¡ç† â­â­
- â³ ç”¨æˆ·ä»»åŠ¡æ•°é‡é™åˆ¶
- â³ æ¯æ—¥æ‰§è¡Œæ¬¡æ•°é™åˆ¶
- â³ æ•°æ®å­˜å‚¨é…é¢
- â³ ç®¡ç†å‘˜å¯è°ƒæ•´é…é¢

#### 11. ä»»åŠ¡åä½œåŠŸèƒ½ â­
- â³ ä»»åŠ¡åˆ†äº«ï¼ˆåªè¯»/ç¼–è¾‘æƒé™ï¼‰
- â³ ä»»åŠ¡è¯„è®ºå’Œæ ‡æ³¨
- â³ æ‰§è¡Œå†å²æŸ¥çœ‹æƒé™æ§åˆ¶
- â³ å›¢é˜Ÿ/ç»„ç»‡ç®¡ç†

### ğŸ”µ æ€§èƒ½ä¼˜åŒ–

#### 12. æ•°æ®åº“ä¼˜åŒ–
- â³ æ·»åŠ ç´¢å¼•ï¼ˆæ£€æŸ¥å¸¸ç”¨æŸ¥è¯¢å­—æ®µï¼‰
- â³ æŸ¥è¯¢ä¼˜åŒ–ï¼ˆé¿å… N+1 é—®é¢˜ï¼‰
- â³ è¿æ¥æ± é…ç½®ä¼˜åŒ–
- â³ æ…¢æŸ¥è¯¢æ—¥å¿—

#### 13. ç¼“å­˜ç­–ç•¥
- â³ API å“åº”ç¼“å­˜
- â³ ä»»åŠ¡é…ç½®ç¼“å­˜
- â³ ç”¨æˆ·ä¼šè¯ç¼“å­˜ä¼˜åŒ–
- â³ çƒ­ç‚¹æ•°æ®ç¼“å­˜

#### 14. æ–‡ä»¶ä¸Šä¼ ä¼˜åŒ–
- â³ æ·»åŠ æ–‡ä»¶å¤§å°é™åˆ¶ï¼ˆéƒ¨åˆ†å·²å®ç°ï¼‰
- â³ æ–‡ä»¶ç±»å‹éªŒè¯ï¼ˆéƒ¨åˆ†å·²å®ç°ï¼‰
- â³ æ–‡ä»¶å­˜å‚¨è·¯å¾„ä¼˜åŒ–
- â³ å¤§æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ 

#### 15. å‰ç«¯æ€§èƒ½ä¼˜åŒ–
- â³ ç»„ä»¶æŒ‰éœ€åŠ è½½
- â³ å›¾ç‰‡æ‡’åŠ è½½
- â³ API è¯·æ±‚é˜²æŠ–/èŠ‚æµ
- â³ è™šæ‹Ÿæ»šåŠ¨ï¼ˆå¤§æ•°æ®åˆ—è¡¨ï¼‰

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### ç¯å¢ƒå‡†å¤‡

#### 1. å®‰è£…ä¾èµ–

**åç«¯**:
```bash
cd backend/crawler
npm install
```

**å‰ç«¯**:
```bash
cd fronted/Crawler
npm install
```

#### 2. é…ç½®ç¯å¢ƒå˜é‡

åœ¨ `backend/crawler` ç›®å½•ä¸‹åˆ›å»º `.env` æ–‡ä»¶ï¼š

```env
# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASS=your_password
DB_NAME=crawlee_lowcode

# Redis é…ç½®
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# JWT é…ç½®
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
JWT_EXPIRES_IN=86400

# æœåŠ¡å™¨é…ç½®
PORT=3000
NODE_ENV=development

# CORS é…ç½®ï¼ˆç”Ÿäº§ç¯å¢ƒè¯·ä¿®æ”¹ä¸ºå…·ä½“åŸŸåï¼‰
ALLOWED_ORIGINS=http://localhost:5173,http://localhost:3000

# é€Ÿç‡é™åˆ¶é…ç½®
THROTTLE_TTL=60
THROTTLE_LIMIT=100
```

**è¯¦ç»†é…ç½®è¯´æ˜**: å‚è€ƒ `backend/crawler/ENV_SETUP.md`

#### 3. åˆå§‹åŒ–æ•°æ®åº“

```bash
cd backend/crawler
# è¿è¡Œæ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
node init-database.js
```

### å¯åŠ¨é¡¹ç›®

#### å¯åŠ¨åç«¯

```bash
cd backend/crawler
npm run start:dev
```

åç«¯æœåŠ¡å°†åœ¨ `http://localhost:3000` å¯åŠ¨

#### å¯åŠ¨å‰ç«¯

```bash
cd fronted/Crawler
npm run dev
```

å‰ç«¯æœåŠ¡å°†åœ¨ `http://localhost:5173` å¯åŠ¨

### è®¿é—®æœåŠ¡

- **å‰ç«¯åº”ç”¨**: http://localhost:5173
- **åç«¯ API**: http://localhost:3000
- **Swagger æ–‡æ¡£**: http://localhost:3000/api
- **å¥åº·æ£€æŸ¥**: http://localhost:3000/health

### åŸºæœ¬ä½¿ç”¨æµç¨‹

#### 1. æ³¨å†Œå’Œç™»å½•

1. è®¿é—®å‰ç«¯åº”ç”¨
2. ç‚¹å‡»"æ³¨å†Œ"åˆ›å»ºè´¦å·
3. è¾“å…¥é‚®ç®±ï¼Œè·å–éªŒè¯ç 
4. å®Œæˆæ³¨å†Œåç™»å½•

#### 2. åˆ›å»ºçˆ¬è™«ä»»åŠ¡

1. ç‚¹å‡»"æ–°å¢ä»»åŠ¡"
2. **æ­¥éª¤1 - åŸºæœ¬ä¿¡æ¯**: è¾“å…¥ä»»åŠ¡åç§°å’Œ URL
3. **æ­¥éª¤2 - ç»“æ„é€‰æ‹©**: 
   - é€‰æ‹©"åˆ—è¡¨ç»“æ„"æˆ–"æ–‡ç« ç»“æ„"
   - æˆ–ä½¿ç”¨è‡ªåŠ¨è¯†åˆ«åŠŸèƒ½
4. **æ­¥éª¤3 - å­—æ®µæ˜ å°„**:
   - æ·»åŠ è¦æå–çš„å­—æ®µ
   - é…ç½®é€‰æ‹©å™¨ï¼ˆXPath æˆ– JSPathï¼‰
   - è®¾ç½®å­—æ®µç±»å‹ï¼ˆæ–‡æœ¬/é“¾æ¥/å›¾ç‰‡ï¼‰
5. **æ­¥éª¤4 - é«˜çº§é…ç½®**:
   - è®¾ç½®æµè§ˆå™¨å‚æ•°
   - é…ç½®å¹¶å‘æ•°ã€è¶…æ—¶ç­‰
6. **æ­¥éª¤5 - é¢„è§ˆ**: é¢„è§ˆçˆ¬å–ç»“æœ
7. ä¿å­˜ä»»åŠ¡

#### 3. æ‰§è¡Œä»»åŠ¡

1. åœ¨ä»»åŠ¡åˆ—è¡¨ä¸­ç‚¹å‡»"å¿«é€Ÿæ‰§è¡Œ"
2. ç³»ç»Ÿä¼šåˆ›å»ºæ–°ä»»åŠ¡å‰¯æœ¬å¹¶æ‰§è¡Œ
3. é€šè¿‡ WebSocket å®æ—¶æŸ¥çœ‹æ‰§è¡Œè¿›åº¦
4. æ‰§è¡Œå®ŒæˆåæŸ¥çœ‹ç»“æœ

#### 4. æŸ¥çœ‹ç»“æœ

1. åœ¨ä»»åŠ¡åˆ—è¡¨ä¸­å±•å¼€ä»»åŠ¡è¡Œ
2. æŸ¥çœ‹çˆ¬å–çš„æ•°æ®
3. å¯ä»¥å¯¼å‡ºä¸º JSON æˆ– ZIP æ ¼å¼

#### 5. å¯¼å‡ºæ•°æ®

1. åœ¨ä»»åŠ¡ç»“æœé¡µé¢ç‚¹å‡»"æ‰“åŒ…ç»“æœ"
2. é€‰æ‹©å¯¼å‡ºæ ¼å¼å’Œé…ç½®
3. ä¸‹è½½å¯¼å‡ºçš„æ–‡ä»¶

---

## ğŸ“¡ API æ¥å£

### è®¤è¯ç›¸å…³

#### ç”¨æˆ·æ³¨å†Œ
```
POST /api/user/register
Body: {
  email: string
  password: string
  code: string  // éªŒè¯ç 
}
```

#### ç”¨æˆ·ç™»å½•
```
POST /api/user/login
Body: {
  email: string
  password: string
}
Response: {
  user: UserDto
}
// Token é€šè¿‡ HttpOnly Cookie è¿”å›
```

#### è·å–éªŒè¯ç 
```
GET /api/user/captcha
Response: {
  captchaId: string
  svg: string
}
```

#### å‘é€é‚®ç®±éªŒè¯ç 
```
POST /api/user/send-code
Body: {
  email: string
  captchaId: string
  captchaText: string
}
```

### ä»»åŠ¡ç›¸å…³

#### è·å–ä»»åŠ¡åˆ—è¡¨
```
GET /api/task/list?page=1&limit=10&search=å…³é”®è¯
Headers: Cookie: token=xxx
Response: {
  data: TaskItem[]
  pagination: {
    page: number
    limit: number
    total: number
    totalPages: number
  }
}
```

#### æ‰§è¡Œä»»åŠ¡
```
POST /api/task/execute
Body: {
  taskId?: string        // å¯é€‰ï¼Œä¸ä¼ åˆ™åˆ›å»ºæ–°ä»»åŠ¡
  taskName?: string      // æ–°ä»»åŠ¡åç§°
  url?: string          // æ–°ä»»åŠ¡ URL
  config?: CrawleeTaskConfig  // ä»»åŠ¡é…ç½®
  overrideConfig?: Partial<CrawleeTaskConfig>  // è¦†ç›–é…ç½®
}
Response: {
  executionId: number
  status: 'queued' | 'running' | 'success' | 'failed'
  message: string
  queueStatus: {...}
}
```

#### åˆ é™¤ä»»åŠ¡
```
DELETE /api/task
Body: {
  name: string
  url: string
}
```

#### è·å–æ‰§è¡Œç»“æœ
```
GET /api/task/execution-result/:executionId
Response: {
  executionId: number
  taskId: number
  taskName: string
  status: string
  resultCount: number
  results: any[]
  createdAt: string
}
```

#### æ‰“åŒ…ç»“æœ
```
POST /api/task/package-result/:executionId
Body: {
  packageConfig: {
    structure?: {...}
    download?: {...}
    fieldMapping?: {...}
  }
}
Response: {
  message: string
  packagePath: string
}
```

#### è·å–ç»Ÿè®¡æ•°æ®
```
GET /api/task/statistics
Response: {
  totalTasks: number
  successTasks: number
  runningTasks: number
  failedTasks: number
  successRate: number
  trendData: Array<{...}>
  // ... æ›´å¤šç»Ÿè®¡ä¿¡æ¯
}
```

### ä»»åŠ¡è¾…åŠ©æ¥å£

#### é¢„è§ˆæˆªå›¾
```
POST /api/task/preview-screenshot
Body: {
  url: string
}
Response: {
  screenshotBase64: string
}
```

#### åˆ—è¡¨ç»“æ„è¯†åˆ«
```
POST /api/task/list-preview
Body: {
  url: string
  targetAspectRatio?: number
  tolerance?: number
}
```

#### XPath è§£æ
```
POST /api/task/xpath-parse
Body: {
  url: string
  xpath: string
  contentFormat?: 'text' | 'html' | 'markdown' | 'smart'
}
Response: {
  count: number
  items: ParseResult
}
```

#### JSPath è§£æ
```
POST /api/task/jspath-parse
Body: {
  url: string
  jsPath: string
  waitSelector?: string
  contentFormat?: 'text' | 'html' | 'markdown' | 'smart'
}
```

### ç”¨æˆ·ç›¸å…³

#### è·å–ç”¨æˆ·ä¿¡æ¯
```
GET /api/user/profile
Response: {
  id: number
  email: string
  username: string
  role: string
  avatar?: string
}
```

#### æ›´æ–°ç”¨æˆ·ä¿¡æ¯
```
PATCH /api/user/profile
Body: {
  username?: string
  avatar?: string
}
```

#### ä¿®æ”¹å¯†ç 
```
PATCH /api/user/password
Body: {
  oldPassword: string
  newPassword: string
}
```

#### ä¸Šä¼ å¤´åƒ
```
POST /api/user/avatar
Content-Type: multipart/form-data
Body: {
  file: File
}
```

### ç®¡ç†å‘˜æ¥å£

#### è·å–æ‰€æœ‰ç”¨æˆ·
```
GET /api/user/all?page=1&limit=10&search=å…³é”®è¯
```

#### è·å–ç³»ç»Ÿæ—¥å¿—
```
GET /api/admin/logs?page=1&limit=20&level=info&module=system&startDate=&endDate=
```

#### è·å–ç³»ç»Ÿè®¾ç½®
```
GET /api/admin/settings
```

#### æ›´æ–°ç³»ç»Ÿè®¾ç½®
```
PATCH /api/admin/settings
Body: {
  // è®¾ç½®å¯¹è±¡
}
```

### å¥åº·æ£€æŸ¥

#### å®Œæ•´å¥åº·æ£€æŸ¥
```
GET /health
Response: {
  status: 'ok' | 'error'
  info: {
    database: { status: 'up' }
    memory_heap: { status: 'up' }
    memory_rss: { status: 'up' }
    redis: { status: 'up' }
  }
}
```

#### å°±ç»ªæ£€æŸ¥
```
GET /health/ready
```

#### å­˜æ´»æ£€æŸ¥
```
GET /health/live
Response: {
  status: 'ok'
  timestamp: string
}
```

---

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
crawlee-lowcode-platform/
â”œâ”€â”€ backend/
â”‚   â””â”€â”€ crawler/
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ admin/          # ç®¡ç†å‘˜æ¨¡å—
â”‚       â”‚   â”œâ”€â”€ auth/           # è®¤è¯æ¨¡å—
â”‚       â”‚   â”œâ”€â”€ common/          # å…¬å…±æ¨¡å—ï¼ˆæ‹¦æˆªå™¨ã€è¿‡æ»¤å™¨ç­‰ï¼‰
â”‚       â”‚   â”œâ”€â”€ config/         # é…ç½®æ¨¡å—
â”‚       â”‚   â”œâ”€â”€ execution/      # æ‰§è¡Œè®°å½•æ¨¡å—
â”‚       â”‚   â”œâ”€â”€ health/         # å¥åº·æ£€æŸ¥æ¨¡å—
â”‚       â”‚   â”œâ”€â”€ mail/           # é‚®ä»¶æœåŠ¡æ¨¡å—
â”‚       â”‚   â”œâ”€â”€ redis/          # Redis æ¨¡å—
â”‚       â”‚   â”œâ”€â”€ result/         # ç»“æœæ¨¡å—
â”‚       â”‚   â”œâ”€â”€ task/           # ä»»åŠ¡æ¨¡å—ï¼ˆæ ¸å¿ƒï¼‰
â”‚       â”‚   â”œâ”€â”€ user/           # ç”¨æˆ·æ¨¡å—
â”‚       â”‚   â”œâ”€â”€ app.module.ts   # æ ¹æ¨¡å—
â”‚       â”‚   â””â”€â”€ main.ts         # å…¥å£æ–‡ä»¶
â”‚       â”œâ”€â”€ dist/               # ç¼–è¯‘è¾“å‡º
â”‚       â”œâ”€â”€ uploads/            # ä¸Šä¼ æ–‡ä»¶ç›®å½•
â”‚       â”œâ”€â”€ storage/            # Crawlee å­˜å‚¨ç›®å½•
â”‚       â”œâ”€â”€ screenshots/        # æˆªå›¾ç›®å½•
â”‚       â”œâ”€â”€ package.json
â”‚       â”œâ”€â”€ tsconfig.json
â”‚       â””â”€â”€ .env                # ç¯å¢ƒå˜é‡ï¼ˆéœ€åˆ›å»ºï¼‰
â”‚
â”œâ”€â”€ fronted/
â”‚   â””â”€â”€ Crawler/
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ api/            # API æ¥å£å®šä¹‰
â”‚       â”‚   â”œâ”€â”€ assets/         # é™æ€èµ„æº
â”‚       â”‚   â”œâ”€â”€ components/     # å…¬å…±ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ composables/   # ç»„åˆå¼å‡½æ•°
â”‚       â”‚   â”œâ”€â”€ layouts/       # å¸ƒå±€ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ router/        # è·¯ç”±é…ç½®
â”‚       â”‚   â”œâ”€â”€ stores/        # Pinia çŠ¶æ€ç®¡ç†
â”‚       â”‚   â”œâ”€â”€ types/         # TypeScript ç±»å‹å®šä¹‰
â”‚       â”‚   â”œâ”€â”€ utils/         # å·¥å…·å‡½æ•°
â”‚       â”‚   â”œâ”€â”€ views/         # é¡µé¢ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ App.vue
â”‚       â”‚   â””â”€â”€ main.ts
â”‚       â”œâ”€â”€ package.json
â”‚       â””â”€â”€ vite.config.ts
â”‚
â”œâ”€â”€ README.md                   # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ PROJECT_DOCUMENTATION.md    # æœ¬æ–‡æ¡£
â”œâ”€â”€ OPTIMIZATION_COMPLETE.md    # ä¼˜åŒ–å®Œæˆæ€»ç»“
â”œâ”€â”€ OPTIMIZATION_RECOMMENDATIONS.md  # ä¼˜åŒ–å»ºè®®
â”œâ”€â”€ QUICK_START.md              # å¿«é€Ÿå¼€å§‹æŒ‡å—
â””â”€â”€ ENV_SETUP.md                # ç¯å¢ƒå˜é‡é…ç½®è¯´æ˜
```

---

## ğŸ”§ å¼€å‘æŒ‡å—

### åç«¯å¼€å‘

#### æ·»åŠ æ–°æ¨¡å—
```bash
cd backend/crawler
nest g module module-name
nest g controller module-name
nest g service module-name
```

#### è¿è¡Œæµ‹è¯•
```bash
npm run test
npm run test:watch
npm run test:cov
npm run test:e2e
```

#### ä»£ç æ ¼å¼åŒ–
```bash
npm run format
npm run lint
```

### å‰ç«¯å¼€å‘

#### æ·»åŠ æ–°é¡µé¢
1. åœ¨ `src/views/` åˆ›å»º Vue ç»„ä»¶
2. åœ¨ `src/router/index.ts` æ·»åŠ è·¯ç”±
3. å¦‚éœ€ APIï¼Œåœ¨ `src/api/` æ·»åŠ æ¥å£å®šä¹‰

#### è¿è¡Œæµ‹è¯•
```bash
npm run test
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `README.md` - é¡¹ç›®åŸºç¡€è¯´æ˜
- `QUICK_START.md` - å¿«é€Ÿå¼€å§‹æŒ‡å—
- `OPTIMIZATION_COMPLETE.md` - ä¼˜åŒ–å®Œæˆæ€»ç»“
- `OPTIMIZATION_RECOMMENDATIONS.md` - è¯¦ç»†ä¼˜åŒ–å»ºè®®
- `ENV_SETUP.md` - ç¯å¢ƒå˜é‡é…ç½®è¯´æ˜
- `backend/crawler/src/task/README.md` - ä»»åŠ¡æ‰§è¡Œæ¥å£è¯´æ˜

---

## ğŸ› å¸¸è§é—®é¢˜

### 1. å¯åŠ¨å¤±è´¥ï¼šæ‰¾ä¸åˆ°ç¯å¢ƒå˜é‡
**è§£å†³**: ç¡®ä¿åœ¨ `backend/crawler` ç›®å½•ä¸‹åˆ›å»ºäº† `.env` æ–‡ä»¶

### 2. 429 é”™è¯¯ï¼ˆé€Ÿç‡é™åˆ¶ï¼‰
**è§£å†³**: è¿™æ˜¯æ­£å¸¸çš„ä¿æŠ¤æœºåˆ¶ã€‚å¼€å‘æ—¶å¯ä¸´æ—¶å¢åŠ  `THROTTLE_LIMIT` å€¼

### 3. CORS é”™è¯¯
**è§£å†³**: æ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„ `ALLOWED_ORIGINS` é…ç½®

### 4. å¥åº·æ£€æŸ¥å¤±è´¥
**è§£å†³**: ç¡®ä¿ MySQL å’Œ Redis æœåŠ¡æ­£åœ¨è¿è¡Œ

### 5. WebSocket è¿æ¥å¤±è´¥
**è§£å†³**: æ£€æŸ¥åç«¯ WebSocket é…ç½®å’Œå‰ç«¯è¿æ¥åœ°å€

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### 2024å¹´ - ä¼˜åŒ–ç‰ˆæœ¬

#### å®‰å…¨æ€§ä¼˜åŒ–
- âœ… ç¯å¢ƒå˜é‡é…ç½®ç®¡ç†
- âœ… CORS é…ç½®ä¼˜åŒ–
- âœ… API é€Ÿç‡é™åˆ¶
- âœ… æ•æ„Ÿä¿¡æ¯æ¸…ç†

#### ä»£ç è´¨é‡ä¼˜åŒ–
- âœ… æ—¥å¿—ç³»ç»Ÿç»Ÿä¸€åŒ–
- âœ… API æ–‡æ¡£å®Œå–„
- âœ… å¥åº·æ£€æŸ¥æ¥å£

#### åŠŸèƒ½ä¼˜åŒ–
- âœ… å¿«é€Ÿæ‰§è¡ŒåŠŸèƒ½ä¼˜åŒ–ï¼ˆåˆ›å»ºæ–°ä»»åŠ¡è€Œéè¦†ç›–ï¼‰

---

## ğŸ“„ è®¸å¯è¯

MIT License

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  

